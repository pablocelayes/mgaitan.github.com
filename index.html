<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="&gt;&gt;&gt; me.geek.post()">
<meta name="viewport" content="width=device-width">
<title>tin_nqn | tin_nqn</title>
<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="en/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="rss.xml">
<link rel="canonical" href="http://mgaitan.github.io/index.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><link href="assets/css/custom.css" rel="stylesheet">
</head>
<body>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://mgaitan.github.io/">

                <div id="blog-title">
                    tin_nqn
                    <span id="blog-description">&gt;&gt;&gt; me.geek.post()</span>
                </div>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
<li>
<a href="about.html">Sobre mí</a>
                </li>
<li>
<a href="charlas.html">Charlas</a>
                </li>
<li>
<a href="archive.html">Archivos</a>
                </li>
<li>
<a href="categories/index.html">Categorías</a>
                </li>
<li>
<a href="rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>            </li>
<li><a href="en/index.html" rel="alternate" hreflang="en">English</a></li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">

            <div class="col-md-offset-2 col-md-8">
            
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/lo-siento-por-vos.html" class="u-url">Lo siento por vos</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/lo-siento-por-vos.html" rel="bookmark"><time class="published dt-published" datetime="2014-05-11T22:23:44-03:00" itemprop="datePublished" title="Fecha de publicación">2014-05-11 22:23</time></a></p>
                <p class="commentline">            <a href="posts/lo-siento-por-vos.html#disqus_thread" data-disqus-identifier="cache/posts/lo-siento-por-vos.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>A fines de enero, apenas <a class="reference external" href="https://www.youtube.com/watch?v=95ZzSM-BlZI">volvimos de Ushuaia</a>, en la góndola de los fideos del Vea de mi barrio decidí que iba a retomar <a class="reference external" href="http://mgaitan.github.io/posts/hola-preciosa.html">Preciosa</a>. Hice un aviso en la lista de correo y <a class="reference external" href="https://twitter.com/tin_nqn_/status/425463037110124546">lo tuiteé</a>, sin esperar mucha respuesta.</p>
<p>Cuando salieron las primeras aplicaciones para "Precios Cuidados",
Luciano Ferrer me <a class="reference external" href="https://twitter.com/luuuciano/status/429027032408657920">preguntó</a> si eran lo mismo que lo que yo quería hacer. Le respondí que Preciosa era mucho más que eso, pero todavía tenía dudas sobre cómo concretarlo:</p>
<blockquote class="twitter-tweet" data-conversation="none" lang="es">
<p><a href="https://twitter.com/luuuciano">@luuuciano</a> todo eso. pero soy vago, pobre y mal reclutador de voluntarios. veremos si algun dia ve la luz... y a qué precio (cuac!)</p>— Martín Gaitán (@tin_nqn_) <a href="https://twitter.com/tin_nqn_/statuses/429032006911946753">enero 30, 2014</a>
</blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>Tres meses después Preciosa tiene una primera versión con casi 2000 descargas, 400 usuarios activos, múltiples <a class="reference external" href="http://preciosdeargentina.com.ar/preciosa-en-los-medios">aparaciones en radio y TV</a> y muchísimas ideas y ganas para seguir creciendo.</p>
<p class="more"><a href="posts/lo-siento-por-vos.html">Leer más…</a></p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/no-al-fraude-en-cordoba-nuevo-analisis.html" class="u-url">Nuevo análisis #NoAlFraudeEnCordoba</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/no-al-fraude-en-cordoba-nuevo-analisis.html" rel="bookmark"><time class="published dt-published" datetime="2013-11-02T16:20:21-03:00" itemprop="datePublished" title="Fecha de publicación">2013-11-02 16:20</time></a></p>
                <p class="commentline">            <a href="posts/no-al-fraude-en-cordoba-nuevo-analisis.html#disqus_thread" data-disqus-identifier="cache/posts/noalfraudeencordoba-nuevas-listas.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>La repecursión que causó el <a class="reference external" href="http://mgaitan.github.io/posts/no-al-fraude-en-cordoba-ayudanos.html">análisis de datos para filtrar mesas estadísticamente sospechosas</a> me sorprendió totalmente.</p>
<p>Se registraron más de <a class="reference external" href="https://docs.google.com/spreadsheet/ccc?key=0Au9td98rqeZ0dHVqMlltQ1FzSmd0LTcxcFZwY2JYY3c&amp;usp=sharing">200 reportes de irregularidades</a>
a través del formulario y otros tantos en los comentarios de los articulo previos a que pusiera ese sistema de aviso.</p>
<p>Además, no sólo salió en los medios (para <a class="reference external" href="http://pages.citebite.com/k2l2d5g4g7qky">algunos</a> con mala leche soy "kirchnerista <em>pero</em> democrático") , sino que Liliana Olivero se comunicó conmigo para agradecerme y preguntarme si podíamos obtener más información. Hoy me reuní con integrantes del Frente de Izquierda para
hacer <a class="reference external" href="http://nbviewer.ipython.org/7281371">nuevos reportes</a>.</p>
<p class="more"><a href="posts/no-al-fraude-en-cordoba-nuevo-analisis.html">Leer más…</a></p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/no-al-fraude-en-cordoba-ayudanos.html" class="u-url">#NoAlFraudeEnCórdoba. Ayudanos</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/no-al-fraude-en-cordoba-ayudanos.html" rel="bookmark"><time class="published dt-published" datetime="2013-10-30T15:17:55-03:00" itemprop="datePublished" title="Fecha de publicación">2013-10-30 15:17</time></a></p>
                <p class="commentline">            <a href="posts/no-al-fraude-en-cordoba-ayudanos.html#disqus_thread" data-disqus-identifier="cache/posts/elecciones_cba.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">Hay un nuevo artículo relacionado <a class="reference external" href="posts/no-al-fraude-en-cordoba-nuevo-analisis.html">acá</a></p>
</div>
<p>Mi nombre es Martín Gaitán y soy ingeniero  en computación. Quienes me
conocen saben que soy kirchnerista y fui fiscal de Carolina Scotto, pero
antes de eso soy ciudadano y como tal, mi deber cívico es defender la
democracia. En este caso, exigiendo un escrutinio transparente.</p>
<p>El domingo pasado, todas las boca de urna daban a Liliana Olivero,
candidata del Frente de Izquierda y los Trabajadores (FIT), como la 9na
diputada por Córdoba. Ese pronóstico se iba confirmando a lo largo del
escrutinio hasta alrededor de las 23hs, cuando la tendencia empezó a
cambiar en favor del tercer candidato de la UCR, Diego Mestre.</p>
<p>Al ser el margen tan estrecho
(<a class="reference external" href="http://nbviewer.ipython.org/7206288">calculé</a> que son menos de 1600, 0.06%) el partido de Olivero exige el recuento de los votos y <a class="reference external" href="http://www.lavoz.com.ar/politica/desestiman-pedido-del-fit-para-abrir-todas-las-urnas">la justicia electoral se
niega</a>.</p>
<p>Aún sin el recuento voto a voto, se han encontrado mesas con votos al
FIT mal computados. Algunos ejemplos</p>
<ul class="simple">
<li>
<a class="reference external" href="http://www.resultados.gob.ar/telegramas/04/001/0013J/040010013J2669.htm">Mesa 2669, Cba
Capital</a>:
no se computaron 33 votos del FIT (inferido)</li>
<li>
<a class="reference external" href="http://www.resultados.gob.ar/telegramas/04/001/0006E/040010006E0611.htm">Mesa 611, Cba
Capita</a>:
no se computaron 23 votos del FIT (inferido)</li>
<li>
<a class="reference external" href="http://t.co/oahdUgFwEu">Mesa 1064</a>: se computaron 10 en vez de 40
votos del Frente de Izquierda.</li>
</ul>
<p class="more"><a href="posts/no-al-fraude-en-cordoba-ayudanos.html">Leer más…</a></p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/un-procesador-de-restructuredtext.html" class="u-url">Un procesador de reStructuredText</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/un-procesador-de-restructuredtext.html" rel="bookmark"><time class="published dt-published" datetime="2013-09-04T20:38:44-03:00" itemprop="datePublished" title="Fecha de publicación">2013-09-04 20:38</time></a></p>
                <p class="commentline">            <a href="posts/un-procesador-de-restructuredtext.html#disqus_thread" data-disqus-identifier="cache/posts/un-procesador-de-restructuredtext.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Siempre me gustó <a class="reference external" href="http://textosypretextos.com.ar">escribir</a>. Pero, desde que recuerdo, casi siempre lo hice en un teclado de computadora. Salvo <a class="reference external" href="http://es.wikipedia.org/wiki/Garabato_%28dibujo%29">garabatos</a> cuando tengo que pensar algo difícil o cuando me aburro en una reunión/clase, casi no escribo en papel.</p>
<p class="more"><a href="posts/un-procesador-de-restructuredtext.html">Leer más…</a></p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/fortran-windows-pesadilla2.html" class="u-url">Fortran + Windows = pesadilla^2</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/fortran-windows-pesadilla2.html" rel="bookmark"><time class="published dt-published" datetime="2013-08-24T11:11:45-03:00" itemprop="datePublished" title="Fecha de publicación">2013-08-24 11:11</time></a></p>
                <p class="commentline">            <a href="posts/fortran-windows-pesadilla2.html#disqus_thread" data-disqus-identifier="cache/posts/fortran-windows-pesadilla2.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Hace bastante que no escribo en este blog y no es porque tengo <a class="reference external" href="http://www.textosypretextos.com.ar">otro</a>, sino, principalmente, porque estoy con muchísimo trabajo.</p>
<p>Hace casi un mes dejé <a class="footnote-reference" href="posts/fortran-windows-pesadilla2.html#id4" id="id1">[1]</a> de trabajar en <a class="reference external" href="http://machinalis.com">Machinalis</a>, una de las empresas más pythónicamente grosas del mundo mundial <a class="footnote-reference" href="posts/fortran-windows-pesadilla2.html#id5" id="id2">[2]</a>, en la que inevitablemente aprendí muchísimo
(y eso que me esforcé ;-)), hice amigos y laburé en proyectos de una escala y complejidad a la que nunca podría haber aspirado como un "freelance <em>che pibe</em> programador".</p>
<p>Ahora laburo fulltime (o sea: el triple) en <a class="reference external" href="http://phasety.com">Phasety</a>, el proyecto que estamos creando junto a Martín Cismondi, director de mi proyecto integrador de grado hace algunos años ("ingeniero en computación", dice el pelpa) y hoy socio. Cismondi es doctor en ingeniería
química y uno de los especialistas más reputados a nivel mundial en el área "equilibro de fases", que es, básicamente, modelar el comportamiento termodinámico de un fluido mediante algoritmos numéricos.</p>
<p>Un poco por cierta "inercia cultural" del mundo científico (en particular en las área de química computacional) y otro poco porque sigue siendo increíblemente eficiente para rutinas de cálculo, Fortran es el lenguaje predominante en el que los tipos
como Cismondi programan. A lo que si le sumás Windows, las bibliotecas privativas y un flujo de trabajo atado al IDE que aprendieron a "clickear" (en general, Visual Studio),
es todo un problema.</p>
<p>Así que parte de mi laburo es sumergirme en este escabrozo mundo y meter ingeniería de software allí donde nunca la hubo.</p>
<p>Por suerte existe Python, pisando cada vez más fuerte en el mundo de la ciencia y la ingeniería (<a class="reference external" href="http://scipycon.com.ar/">http://scipycon.com.ar/</a>, como ejemplo). Pero, mientras seguimos minimizando
la <a class="reference external" href="http://es.wikipedia.org/wiki/Deuda_t%C3%A9cnica">deuda técnica</a> <a class="reference external" href="http://phasety.com/1/blog/article/curso-taller-python-para-ciencia-e-ingenieria">fomentando</a> esta tecnología, hay que hacerlas convivir.</p>
<div class="section" id="f2py-gfortran-y-lapack-en-windows">
<h2>f2py, gfortran y lapack en Windows</h2>
<p>Estas son notas de lo que he ido logrando hasta el momento en el intento de armar un entorno de desarrollo y empaquetamiento (en lo posible, libre) de software multiplataforma basado en Python y Fortran.</p>
<p>Como se sabe, el "San Valentín" de esta pareja es <a class="reference external" href="http://www.f2py.com">f2py</a>, una herramienta que genera los wrappers necesarios para convertir subrutinas (o funciones) de Fortran en módulos binarios (bibliotecas) importables desde Python.</p>
<p>No abordo acá los detalles de cómo usar f2py (aunque <a class="reference external" href="http://websrv.cs.umt.edu/isis/index.php/F2py_example">este</a> es un buen ejemplo), sino cómo conseguir que funcione para un ejemplo no trivial en windows, compilando con gfortran y linkeando con la biblioteca Lapack.</p>
<ol class="arabic">
<li>
<p class="first">Instalar <a class="reference external" href="https://store.continuum.io/cshop/anaconda/">Anaconda</a>, de Continuum Analytics.</p>
<p>Anaconda es una distribución de Python y una amplia colección de paquetes
y bibliotecas para computación científica, que se pueden instalar con el gestor
<tt class="docutils literal">conda</tt> (análogo a <tt class="docutils literal"><span class="pre">apt-get</span> + pip + virtualenv</tt>) que viene incluído.</p>
<p>Este <em>framework</em> gratuito simplifica muchísimo la instalación de un entorno
de computación científica en Windows.</p>
<p>La versión <a class="reference external" href="http://repo.continuum.io/miniconda/index.html">Miniconda</a> instala sólo Python y conda. Luego podemos instalar paquetes
desde la consola (<tt class="docutils literal">cmd.exe</tt>). Por ejemplo:</p>
<pre class="literal-block">
$ conda install ipython numpy mingw32
</pre>
</li>
<li>
<p class="first">Configurar gfortran</p>
<p>A través de <tt class="docutils literal">conda</tt> puede instalarse MinGW, el conjunto herramientas GNU
para tener un entorno de compilación basado en GCC en Windows. Esto incluye, entre otros, <a class="reference external" href="http://en.wikipedia.org/wiki/Gfortran">gfortran</a>.</p>
<p>Anaconda wrappea <tt class="docutils literal">gfortran.exe</tt> con el archivo batch <tt class="docutils literal"><span class="pre">c:/Anaconda/Scripts/gfortran.bat</span></tt>.
Modificarlo para que linkee estáticamente con <em>libgcc</em> y <em>libgfortran</em>. Quedaría así:</p>
<pre class="literal-block">
@echo off
%~f0\..\..\MinGW\bin\gfortran.exe -static-libgcc -static-libgfortran %*
</pre>
</li>
</ol>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">podés bajar todos los archivos mencionados desde el paso 3 al 5
(para 32bits) desde <a class="reference external" href="https://docs.google.com/file/d/0Bx300vaUNYn1cDVva0FGaEFQTFE/edit?usp=sharing">este zip</a></p>
</div>
<ol class="arabic" start="3">
<li>
<p class="first">Instalar lapack y blas</p>
<p>Aún cuando la única virtud de Fortran es ser eficiente para operaciones basadas en arrays, <a class="reference external" href="http://www.nsc.liu.se/~boein/f77to90/a5.html">no trae</a> una biblioteca estándar incorporada de "alto nivel".</p>
<p>Para no tener que reinventar (<em>"copypastear"</em>) subrutinas todo el tiempo, se linkea con bibliotecas de terceros que, en general, utilizan una nomenclatura común para las
signaturas. <a class="footnote-reference" href="posts/fortran-windows-pesadilla2.html#id6" id="id3">[3]</a></p>
<p><a class="reference external" href="http://netlib.org/lapack">Lapack</a> es la más completa y mantenida biblioteca libre para álgebra lineal, incluyendo rutinas de resolución de sistemas de ecuaciones lineales, factorización de matrices,
etc. Se basa a su vez en la biblioteca BLAS
que implementa las rutinas de más bajo nivel como rotación y producto de matrices.</p>
<p>Todo código numérico no trivial utiliza alguna subrutina de Lapack/BLAS.</p>
<p>Compilarlas en Windows es un lio, pero por suerte ya
<a class="reference external" href="http://icl.cs.utk.edu/lapack-for-windows/lapack/index.html#libraries">lo hicieron otros</a>.</p>
<p>Hay que bajar <tt class="docutils literal">libblas.dll</tt> y <tt class="docutils literal">liblapack.dll</tt> (las que correspondan para tu arquitectura) y copiarlas en
<tt class="docutils literal"><span class="pre">c:\Anaconda\MinGW\i686-w64-mingw32\lib</span></tt> y <tt class="docutils literal"><span class="pre">c:/windows/system32</span></tt></p>
<p>Tambien bajar <tt class="docutils literal">libblas.lib</tt> y <tt class="docutils literal">liblapack.lib</tt> y ponerlas en
<tt class="docutils literal"><span class="pre">c:\Anaconda\libs</span></tt></p>
</li>
<li>
<p class="first">dlls en <tt class="docutils literal"><span class="pre">c:/windows/system32</span></tt></p>
<p>Además de las bajadas, para que el programa se pueda ejecutar hace falta que Lapack encuentre las librerias de las que depende (ya que no está compilado de manera estática)</p>
<p>Hace falta bajar <a class="reference external" href="http://sourceforge.net/projects/mingw/files/MinGW/Base/gcc/Version4/Previous%20Release%20gcc-4.4.0/gcc-core-4.4.0-mingw32-dll.tar.gz/download">gcc-core-4.4.0-mingw32-dll.tar.gz</a>, descomprimirlo y copiar <tt class="docutils literal"><span class="pre">libgcc_s_dw2-1.dll</span></tt>
a <tt class="docutils literal"><span class="pre">c:/windows/system32</span></tt>.</p>
<p>También habrá que copiar allí algunas dll que ya vienen
en la instación de MinGW (buscarlas en <tt class="docutils literal"><span class="pre">c:\Anaconda\MinGW\i686-w64-mingw32\lib</span></tt>):</p>
<pre class="literal-block">
libgcc_s_sjlj-1.dll
libgfortran-3.dll
libquadmath-0.dll
</pre>
</li>
<li>
<p class="first">Bajar libmsvcr90.a</p>
<p>Desde <a class="reference external" href="https://github.com/enthought/vendor-mingw/blob/master/msvcrt/libmsvcr90.a?raw=true">acá</a> y ponerlo en la carpeta <tt class="docutils literal"><span class="pre">c:/Anaconda/libs/</span></tt></p>
</li>
<li>
<p class="first">Listo! Si todo salió bien, ya podés compilar en windows modulos python
implementados en fortran</p>
</li>
</ol>
<p>Como ejemplo,  podés probar con esta subrutina que hace lo mismo que
<tt class="docutils literal">numpy.linalg.solve</tt> (resolver un sistema lineal Ax=b), basada en la rutina <tt class="docutils literal">SGESV</tt>
de lapack (para simple precisión).</p>
<pre class="code fortran literal-block">
<span class="k">subroutine </span><span class="nv">solve</span><span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">b</span><span class="p">,</span> <span class="nv">x</span><span class="p">,</span> <span class="nv">n</span><span class="p">)</span>
    <span class="k">implicit none</span>

    <span class="c">! solving the matrix equation A*x=b using LAPACK
</span>    <span class="c">! declarations, notice single precision
</span>    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="nv">n</span><span class="p">,</span><span class="nv">n</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="nv">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">A</span>
    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="nv">n</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="nv">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">b</span>
    <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="nv">n</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="nv">out</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">x</span>

    <span class="kt">integer</span> <span class="kd">::</span> <span class="nv">i</span><span class="p">,</span> <span class="nv">j</span><span class="p">,</span> <span class="nv">pivot</span><span class="p">(</span><span class="nv">n</span><span class="p">),</span> <span class="nv">ok</span>

    <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="nv">in</span><span class="p">)</span> <span class="kd">::</span> <span class="nv">n</span>

    <span class="c">! find the solution using the LAPACK routine SGESV
</span>    <span class="k">call </span><span class="nv">SGESV</span><span class="p">(</span><span class="nv">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nv">A</span><span class="p">,</span> <span class="nv">n</span><span class="p">,</span> <span class="nv">pivot</span><span class="p">,</span> <span class="nv">b</span><span class="p">,</span> <span class="nv">n</span><span class="p">,</span> <span class="nv">ok</span><span class="p">)</span>

    <span class="c">! copy the vector x
</span>    <span class="nv">x</span> <span class="o">=</span> <span class="nv">b</span>

<span class="k">end subroutine</span>
</pre>
<p>Lo guardamos en un archivo llamado <tt class="docutils literal">linalg.f90</tt> y compilamos:</p>
<pre class="literal-block">
$ f2py --compiler=mingw32 -llapack -m linalg -c linalg.f90
</pre>
<p>Se creeará un archivo <tt class="docutils literal">linalg.pyd</tt> que es importable desde Python.</p>
<pre class="code python literal-block">
<span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">linalg</span> <span class="kn">import</span> <span class="n">solve</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">solve</span><span class="err">?</span>
<span class="n">Type</span><span class="p">:</span>       <span class="n">fortran</span>
<span class="n">String</span> <span class="n">Form</span><span class="p">:</span><span class="o">&lt;</span><span class="n">fortran</span> <span class="nb">object</span><span class="o">&gt;</span>
<span class="n">Docstring</span><span class="p">:</span>
<span class="n">solve</span> <span class="o">-</span> <span class="n">Function</span> <span class="n">signature</span><span class="p">:</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,[</span><span class="n">n</span><span class="p">])</span>
<span class="n">Required</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">a</span> <span class="p">:</span> <span class="nb">input</span> <span class="n">rank</span><span class="o">-</span><span class="mi">2</span> <span class="n">array</span><span class="p">(</span><span class="s">'f'</span><span class="p">)</span> <span class="k">with</span> <span class="n">bound</span>
  <span class="n">b</span> <span class="p">:</span> <span class="nb">input</span> <span class="n">rank</span><span class="o">-</span><span class="mi">1</span> <span class="n">array</span><span class="p">(</span><span class="s">'f'</span><span class="p">)</span> <span class="k">with</span> <span class="n">bound</span>
<span class="n">Optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">n</span> <span class="p">:</span><span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="nb">input</span> <span class="nb">int</span>
<span class="n">Return</span> <span class="n">objects</span><span class="p">:</span>
  <span class="n">x</span> <span class="p">:</span> <span class="n">rank</span><span class="o">-</span><span class="mi">1</span> <span class="n">array</span><span class="p">(</span><span class="s">'f'</span><span class="p">)</span> <span class="k">with</span> <span class="n">bounds</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.19565217</span><span class="p">,</span>  <span class="mf">0.47826087</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
</pre>
<p>Que es lo mismo que</p>
<pre class="code python literal-block">
<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.19565217</span><span class="p">,</span>  <span class="mf">0.47826087</span><span class="p">])</span>
</pre>
<p>¡Salud!</p>
<div class="note">
<p class="first admonition-title">Note</p>
<p class="last">por supuesto, queda resolver lo del IDE (especialmente el debugger)
sin el cual los cientificosprogramadores Fortran se quedan rengos.
Cualquier recomendación es bienvenida.</p>
</div>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/fortran-windows-pesadilla2.html#id1">[1]</a></td>
<td>o "terminé de dejar", porque estaba part-time desde septiembre de 2012.</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/fortran-windows-pesadilla2.html#id2">[2]</a></td>
<td>lo de "empresa pythónica", lo digo <a class="reference external" href="http://www.python.org/dev/peps/pep-0020/">en serio</a>
</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/fortran-windows-pesadilla2.html#id3">[3]</a></td>
<td>La <a class="reference external" href="http://software.intel.com/en-us/intel-mkl">MLK</a> de Intel es una biblioteca matemática optimizada para procesadores
de esta firma. En la parte de algebra lineal utiliza la misma API de Lapack, pero
no es libre y sale 500 verdes :).</td>
</tr></tbody>
</table>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/apuntes-pamejorar-el-chamuio-escrito.html" class="u-url">Apuntes pa'mejorar el chamuio (escrito)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/apuntes-pamejorar-el-chamuio-escrito.html" rel="bookmark"><time class="published dt-published" datetime="2013-06-24T12:35:13-03:00" itemprop="datePublished" title="Fecha de publicación">2013-06-24 12:35</time></a></p>
                <p class="commentline">            <a href="posts/apuntes-pamejorar-el-chamuio-escrito.html#disqus_thread" data-disqus-identifier="cache/posts/apuntes-pamejorar-el-chamuio-escrito.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Finde largo y el emprendorismo autóctono meta que meta, dale que dale, laburando en sus proyectos.</p>
<p>A veces programando, otras barriendo la oficina o atornillando estanterías y otras veces, quizás las más, corrigiendo documentos (plan, cof, de negocios, cof, cof) que tienen que quedar facherazos. No sólo por lo que dicen sino por cómo lo dicen.</p>
<p>Es que así como el "<a class="reference external" href="posts/pitch">chamuyo de ascensor</a>" es algo que se aprende y se entrena, no menor debería ser la importancia de la redacción de nuestros proyectos escritos. Que son, despues de todo, el gran sostén de esta etapa de <a class="reference external" href="posts/phasety">nuestros emprendimientos</a>.</p>
<p>Pero suele pasar: somos muy buenos (ponele) programando y barriendo, te sabemos calcular una derivada parcial y hasta somos capaces de ser simpáticos y entradores en el ascensor... pero damos ocote escribiendo.</p>
<p>¡No os preocupeis! Hete aquí unos apuntes fácilmente masticables que harán las delicias de tod@ emprendedor/a que le pifia al acento y escribe oraciones de 50 palabras porque cree que así se florea
("— Gaitán? — ¡Presente señorita!").</p>
<p>La susodicha que me los facilitó, compañera de andanzas y almohada de este esquenún,
es profesora de traducción periodística en la Universidad Nacional de Córdoba.</p>
<p>Disfruten aprender a poner las comas.</p>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/hola-preciosa.html" class="u-url">Hola Preciosa</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/hola-preciosa.html" rel="bookmark"><time class="published dt-published" datetime="2013-06-02T20:54:17-03:00" itemprop="datePublished" title="Fecha de publicación">2013-06-02 20:54</time></a></p>
                <p class="commentline">            <a href="posts/hola-preciosa.html#disqus_thread" data-disqus-identifier="cache/posts/hola-preciosa.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Mi <a class="reference external" href="posts/mirar-tu-smartphone-para-cuidar.html">propuesta</a> sobre una aplicación para teléfonos inteligentes que facilite el relevamiento
de precios y ayude a encontrar mejores ofertas generó muchísimo debate en <a class="reference external" href="http://listas.python.org.ar/pipermail/pyar/2013-June/thread.html#24966">PyAr</a>, en la
<a class="reference external" href="http://www.textosypretextos.com.ar/spip.php?page=recherche&amp;recherche=limando+cantos">lista de Ingeniería</a>  y en <a class="reference external" href="https://twitter.com/tin_nqn_/status/340839648798580736">Twitter</a> .</p>
<p>Hubo quienes desmerecieron la idea por "<a class="reference external" href="http://listas.python.org.ar/pipermail/pyar/2013-June/024967.html">politizada</a>", otros que me <a class="reference external" href="http://listas.python.org.ar/pipermail/pyar/2013-June/024977.html">invitaron a no generar polémica</a> y llevar la discusión a otro lado <a class="footnote-reference" href="posts/hola-preciosa.html#id4" id="id1">[1]</a>, un par que no les gustó porque le quita <em>"la responsabilidad al gobierno que es el que genera inflación por su irresponsable emisión monetaria"</em>  y otros que directamente se <a class="reference external" href="http://listas.python.org.ar/pipermail/pyar/2013-June/024988.html">ofendieron feo</a> y dijeron que era fascista.</p>
<blockquote class="twitter-tweet" data-conversation="none" lang="es">
<p>@<a href="https://twitter.com/tin_nqn_">tin_nqn_</a> @<a href="https://twitter.com/damian_avila">damian_avila</a> por dios.eso es programar al gran hermano. Facismo en código</p>— JuanB. Cabral (@JuanBCabral) <a href="https://twitter.com/JuanBCabral/status/340955059607187457">1 de junio de 2013</a>
</blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>Pero a la gran mayoría le pareció buena, de difundió bastante en facebook, muchos aportaron nuevas ideas para mejorarla y otros muchos se entusiasmaron en colaborar.</p>
<p>Así que de eso se trata este post: encauzar todas esas ideas y ganas que se generaron para diseñar e implementar el software. Se me ocurrió el nombre <strong>Preciosa</strong> <a class="footnote-reference" href="posts/hola-preciosa.html#id5" id="id2">[2]</a>, por <strong>"Precios de Argentina"</strong> <a class="footnote-reference" href="posts/hola-preciosa.html#id6" id="id3">[3]</a>, pero se puede cambiar más adelante.</p>
<div class="section" id="como-empezamos-preciosa">
<h2>¿Cómo empezamos(,) Preciosa?</h2>
<p>Hice una lista de correos (<a class="reference external" href="https://groups.google.com/forum/?fromgroups#!forum/preciosa-devs">preciosa-devs@googlegroups.com</a>.</p>
<p>Están invitados programadores/as, diseñadore/as, periodistas y todos y todas quienes tengan algo para aportar al proyecto. Es el lugar para discutir ideas de diseño, difusión e implementación, avisar de apps parecidas o útiles, etc.</p>
<p>También dí de alta el proyecto en Github: <a class="reference external" href="https://github.com/mgaitan/preciosa">https://github.com/mgaitan/preciosa</a></p>
<p>Además del repositorio usaremos la <a class="reference external" href="https://github.com/mgaitan/preciosa/wiki">Wiki</a> para resumir los acuerdos de diseño y la <a class="reference external" href="https://github.com/mgaitan/preciosa/issues">issue tracker</a> para listar las tareas y funcionalidades a implementar, pedir nuevas, reportar errores, etc.</p>
<p>Este será el proyecto padre y allí pondremos el código de la aplicación "servidor", es decir la que proveerá la API para que las aplicaciones móviles bajen y suban información de precios. Luego de que decidamos más o menos cómo
será esta API podemos crear un proyecto nuevo para cada una de las aplicaciones clientes de las distintas plataformas mobile (la prioridad debería ser Android y Blackberry, ¿no?).</p>
<p>Porque es lo que yo sé programar, porque es fácil aprenderlo y porque satisface (con creces) tecnológicamente el problema, la aplicación servidor la haremos en <a class="reference external" href="http://">Django</a>.</p>
<p>¿Manos a la obra?</p>
<!-- attention:

Si sabés programar en python, web o cualquier tecnología mobile; sabes diseñar o maquetar css, o simplemente te gusta la idea, te esperamos en la nueva y preciosa lista_ -->
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/hola-preciosa.html#id1">[1]</a></td>
<td>¿esta actitud no es una "<a class="reference external" href="http://www.ted.com/talks/lang/es/eli_pariser_beware_online_filter_bubbles.html">burbuja de filtros</a>", voluntaria? ¿No es <em>"reducir
nuestra visión del mundo"</em> como dice Eli Pariser?</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/hola-preciosa.html#id2">[2]</a></td>
<td>Esteban Morales propuso "DeCompras", que es más explícito e internacionalizable</td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/hola-preciosa.html#id3">[3]</a></td>
<td>o porque me inspiró su <a class="reference external" href="https://plus.google.com/photos/102449284377784435533/albums/5362561505342208481/5362561730845131554?pid=5362561730845131554&amp;oid=102449284377784435533">belleza</a>
</td>
</tr></tbody>
</table>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/mirar-tu-smartphone-para-cuidar.html" class="u-url">Mirar (tu smartphone) para cuidar</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/mirar-tu-smartphone-para-cuidar.html" rel="bookmark"><time class="published dt-published" datetime="2013-06-01T09:50:39-03:00" itemprop="datePublished" title="Fecha de publicación">2013-06-01 09:50</time></a></p>
                <p class="commentline">            <a href="posts/mirar-tu-smartphone-para-cuidar.html#disqus_thread" data-disqus-identifier="cache/posts/mirar-tu-smartphone-para-cuidar.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Leo sobre el programa <a class="reference external" href="http://www.pagina12.com.ar/diario/economia/subnotas/221350-63733-2013-06-01.html">Mirar para cuidar</a>, la campaña de acción voluntaria para controlar el cumplimiento
del <a class="reference external" href="http://www.preciosensusitio.gov.ar/">acuerdo de precios</a> con los supermercados.</p>
<iframe width="420" height="315" src="http://www.youtube.com/embed/I5jQZ8xQ5Pw" frameborder="0" allowfullscreen></iframe><p>Me parece muy bueno todo este paquete de medidas y negociaciones que,
en vez de <a class="reference external" href="https://www.youtube.com/watch?v=tmoOnEIzU18">negar la situación</a>, la
asume y la enfrenta, con medidas simples e ingeniosas. La inflación, creo yo, es el flagelo más sentido por todo el pueblo trabajador.</p>
<p>¿Pero será efectivo tener a tantos compañeros mirando y anotando el precio del paquete de harina
en una hoja de papel?</p>
<p>Supongamos que está más caro de lo acordado ¿Qué va a pasar? Imagino que los voluntarios
tendrán que informarlo a las autoridades de la Secretaria de Comercio y desde allí
deberán enviar a alguien con poder de policia que constate, para luego multar y exigir
la adecuación del precio. ¿Cuantos días lleva eso? ¿Cuanta gente compró la harina más cara
mientras tanto? ¿Cuánto esfuerzo de trabajo significó, no sólo de los voluntarios, sino de los funcionarios? ¿Cuántas posibilidades reales hay de implementar esto en todos los rincones
del país?</p>
<p>Y otra cosa ¿Qué va a pasar con todos los productos que están fuera del acuerdo y no hay
referencia para comparar?</p>
<p>Entonces me acordé de una idea que tuve en la era los celulares sin chip, pero que ahora
es muy factible.</p>
<div class="section" id="una-aplicacion-popular-para-el-control-de-precios">
<h2>Una aplicación "popular" para el control de precios</h2>
<p>Hace 1 año, el <a class="reference external" href="http://www.lanacion.com.ar/1473620-el-smartphone-otra-pasion-argentina">24% de los argentinos tenía un smartphone</a>  y sospecho que, como yo, muchos nos compramos uno
hace menos tiempo. Más de 10 millones de personas que pueden controlar precios con un botón
de su aparatito móvil:</p>
<p>La aplicación que imagino es una base de datos centralizada que los propios usuarios pueden ampliar.</p>
<p>Entran a un super, agarran el paquete de harina, le sacan una fotito con su cámara al código
de barra (o buscan el producto por nombre, marca, etc.) y la <em>app</em> les dice cuál es el
precio de referencia (o del acuerdo), en qué super cercano está más barato,
cuándo y cuánto aumentó, etc.</p>
<p>El usuario puede anotar el precio que está viendo y enviarlo a la base de datos (diciendo
de qué supermercado y sucursal se trata, que podría inferirse a través de geolocalización)
y así contribuir y actualizar los datos.</p>
<p>Este simple proceso de carga de datos distribuída permitiría no sólo controlar el acuerdo de
precios (reemplazando o ayudando eficientemente a los voluntarios mirones) y habilitar a
Moreno (te banco, sabelo) a encajar unas buenas multas, sino algo mucho más efectivo: <strong>que la gente sepa a priori</strong>, mirando su teléfono o la web, <strong>dónde comprar más barato y quién/es la están cagando</strong>.</p>
<p>Por otro lado, la exposición pública de los precios históricos alentaría la competencia de los super, que suelen tener esas políticas estilo <em>"te devolvemos la plata si encontrás un precio más barato"</em> pero que resultan ser mero marketing por la dificultad de utilizarlas.</p>
<p>¡Imaginate la cantidad de datos para analizar! Por ejemplo, ¿cuánto aumentaron en promedio
los productos de <a class="reference external" href="http://www.taringa.net/posts/noticias/12546172/Empresa-que-manejan-casi-todos-los-productos-del-hogar.html">Unilever</a> o <a class="reference external" href="http://www.taringa.net/posts/info/3231784/Kraft-Terrabusi-150-despidos.html">Kraft</a> ? ¿no resultará que son esas empresas (entre otras) las que tienen la batuta de los precios? ¿No podrémos, al menos, escracharlos y boicotearlos?</p>
<p><em>"¡Subiste un 35% las sardinas desde el mes pasado, hijuepú!, ¡Minga te voy a comprar!"</em></p>
</div>
<div class="section" id="lo-hacemos">
<h2>¿Lo hacemos?</h2>
<p>No tengo idea de cómo se hacen aplicaciones para smartphones <a class="footnote-reference" href="posts/mirar-tu-smartphone-para-cuidar.html#id2" id="id1">[1]</a>, pero sí puedo ayudar en
la API/base datos/web.</p>
<p>Así que busco voluntarios para el programa <em>"Programar para cuidar"</em> ;-).</p>
<blockquote>
PD: ¿No se copará la secretaria de defensa del consumidor en poner unos pesos para
hacer esto?</blockquote>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/mirar-tu-smartphone-para-cuidar.html#id1">[1]</a></td>
<td>en verdad, ideas tengo, lo que no tengo son certezas</td>
</tr></tbody>
</table>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/pip-apurate-por-favor.html" class="u-url">pip, apurate por favor</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/pip-apurate-por-favor.html" rel="bookmark"><time class="published dt-published" datetime="2013-04-10T01:17:55-03:00" itemprop="datePublished" title="Fecha de publicación">2013-04-10 01:17</time></a></p>
                <p class="commentline">            <a href="posts/pip-apurate-por-favor.html#disqus_thread" data-disqus-identifier="cache/posts/pip_rapido.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p><a class="reference external" href="http://pip-installer.org/">pip</a>  es una herramienta esencial
para el trabajo diario de un programador python: es el manejador
de paquetes de nuestro entorno de trabajo (¡<a class="reference external" href="http://www.virtualenv.org/en/latest/">virtual</a> por favor!),
con el que instalamos, actualizamos o eliminamos las dependencias de nuestro proyecto
(y, recursivamente, las dependencias que estas pudieran tener).</p>
<p>Conceptualmente es similar a los manejadores de paquetes de sistema como <tt class="docutils literal"><span class="pre">apt-get</span></tt>,
diferenciándose en que, por defecto, <em>consulta cada vez</em> a una <a class="reference external" href="https://pypi.python.org/pypi/">base de
datos online</a> si el paquete solicitado existe y de dónde
puede bajar la última versión o la específica que se haya pedido.</p>
<p>Responder "qué, cuál y de dónde" es una tarea lenta porque dicha base de datos no es
más que una página html por cada paquete con links que funcionan como un índice (como
<a class="reference external" href="https://pypi.python.org/simple/lxml/">este</a>  que pip
<a class="reference external" href="https://github.com/pypa/pip/blob/f1fb4b4fda127529e24b71a4e03bb0b5df484ef6/pip/index.py#L141">debe parsear</a>
comparar y elegir la mejor opción para bajar (a veces incluso debe parsear la homepage
del proyecto en busca de links de descarga, puaj!).</p>
<p>Por eso (y porque muchas veces la infraestructura se satura) el uso estándar de pip es lento.
Pero hay algunas maneras de que lo sea menos. Veámoslas.</p>
<div class="section" id="no-bajes-dos-veces-lo-mismo">
<h2>No bajes dos veces lo mismo</h2>
<p>El funcionamiento básico de pip es instalar un paquete con <tt class="docutils literal">pip install &lt;paquete&gt;</tt>: busca, baja e
instala el paquete. El flag <tt class="docutils literal"><span class="pre">--download_cache=&lt;path&gt;</span></tt> evita repetir el paso del medio,
cosa tediosa cuando tenemos que instalar frecuentemente (por ejemplo en distintos virtualenvs)
la misma dependencia o cuando el uso de ancho de banda es limitado.</p>
<p>Por ejemplo instalamos por primera vez <a class="reference external" href="http://lxml.de/">lxml</a> y vemos cuanto tarda.</p>
<pre class="code bash literal-block">
<span class="o">(</span><span class="nb">test</span><span class="o">)</span>tin@traful:~/lab/test<span class="nv">$ </span><span class="nb">time </span>pip install lxml --download-cache<span class="o">=</span>~/.pip_download
Downloading/unpacking lxml
  Downloading lxml-3.1.1.tar.gz <span class="o">(</span>3.3MB<span class="o">)</span>: 3.3MB downloaded
  Storing download in cache at /home/tin/.pip_download_cache/https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fl%2Flxml%2Flxml-3.1.1.tar.gz
  Running setup.py egg_info <span class="k">for </span>package lxml
    Building lxml version 3.1.1.

    <span class="o">[</span>... compilación<span class="o">]</span>


Successfully installed lxml
Cleaning up...

real    2m58.276s
user    0m38.822s
sys 0m0.676s
<span class="o">(</span><span class="nb">test</span><span class="o">)</span>tin@traful:~/lab/test<span class="err">$</span>
</pre>
<p>¡3 minutos! Y eso que estoy en una conexión bastante rápida.</p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p>Cualquier flag que pip acepta en su linea de comando se puede configurar como una
<a class="reference external" href="http://www.pip-installer.org/en/latest/configuration.html#environment-variables">variable de entorno</a>. Entonces podemos setear flag por defecto en nuestro <tt class="docutils literal">.bashrc</tt>,
por ejemplo.. code-block: bash</p>
<blockquote class="last">
export PIP_DOWNLOAD_CACHE=~/.pip_download_cache</blockquote>
</div>
<p>Pero sigamos: una vez cacheado, las siguientes veces que queramos instalar la misma versión de lxml
no bajará <strong>el archivo</strong> de nuevo</p>
<pre class="code bash literal-block">
<span class="o">(</span>test2<span class="o">)</span>tin@traful:~/lab/test2<span class="nv">$ </span><span class="nb">time </span>pip install lxml --download-cache<span class="o">=</span>~/.pip_download

Downloading/unpacking lxml
  Using download cache from /home/tin/.pip_download_cache/https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fl%2Flxml%2Flxml-3.1.1.tar.gz
  Running setup.py egg_info <span class="k">for </span>package lxml
    Building lxml version 3.1.1.

    <span class="o">[</span>... compilación<span class="o">]</span>

Successfully installed lxml
Cleaning up...

real    2m30.624s
user    0m38.966s
sys 0m0.504s
</pre>
<p>Mejoró realmente poco. ¿que clase de caché es esta?
Chusmeemos que hay en el directorio.</p>
<pre class="code bash literal-block">
<span class="o">(</span><span class="nb">test</span><span class="o">)</span>tin@traful:~/lab/test<span class="nv">$ </span>ls ~/.pip_download_cache/ | grep lxml
https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fl%2Flxml%2Flxml-3.1.1.tar.gz
https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fl%2Flxml%2Flxml-3.1.1.tar.gz.content-type
</pre>
<p>¿Caché de urls? <tt class="docutils literal"><span class="pre">-download-cache</span></tt> no evita todo el laburo de averiguar de dónde bajar,
sino simplemente no baja si la url resultante ya existe (como nombre de un archivo)
en este directorio.</p>
<p>Lo explica simple <a class="reference external" href="https://github.com/pypa/pip/issues/680#issuecomment-8773509">Carl Meyer</a>:</p>
<blockquote>
La función <tt class="docutils literal"><span class="pre">--download-cache</span></tt> no apunta a prevenir la búsqueda en la red del archivo
correcto a bajar: todo lo que hace es guardarlo una vez que lo encontró.
Si de verdad te interesa instalar tus depedencias desde tu compu (sin salir a la red)
usá <tt class="docutils literal"><span class="pre">--download</span></tt> primero y luego <tt class="docutils literal"><span class="pre">--find-links</span></tt> (apuntando al path de descarga) con
<tt class="docutils literal"><span class="pre">--no-index</span></tt>.</blockquote>
</div>
<div class="section" id="una-cache-sin-salir-a-la-red">
<h2>Una caché sin salir a la red</h2>
<p>Sigamosle la corriente al bueno de <a class="reference external" href="https://twitter.com/carljm">@carljm</a>:</p>
<pre class="code bash literal-block">
<span class="o">(</span>test3<span class="o">)</span>tin@traful:~/lab/test3<span class="nv">$ </span><span class="nb">time </span>pip install --download<span class="o">=</span>~/.pip_packages lxml
Downloading/unpacking lxml
  Using download cache from /home/mgaitan/.pip_download_cache/https%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fl%2Flxml%2Flxml-3.1.1.tar.gz
Saved /home/mgaitan/.pip_packages/lxml-3.1.1.tar.gz
    <span class="o">[</span>...<span class="o">]</span>

Successfully downloaded lxml
Cleaning up...

real    2m8.969s
user    0m1.008s
sys 0m0.136s
</pre>
<p>¡Uff, 2 minutos en copiar un archivo que ya tenía bajado! (evidentemente lo que demora mucho
es <em>averiguar</em> la versión del archivo a bajar)</p>
<div class="tip">
<p class="first admonition-title">Tip</p>
<p class="last">se puede inspeccionar el berenjenal de redirecciones y parseos que suceden hasta que pip
da con el paquete lxml a bajar haciendo el comando más verborrágico con
<tt class="docutils literal">pip install lxml <span class="pre">-vvv</span></tt></p>
</div>
<p>En este caso, el caché es directamente el archivo:</p>
<pre class="code bash literal-block">
<span class="o">(</span><span class="nb">test</span><span class="o">)</span>mgaitan@traful:~/lab/test<span class="nv">$ </span>ls ~/.pip_packages/ | grep lxml
lxml-3.1.1.tar.gz
</pre>
<p>Por suerte, una vez cacheado el paquete de esta manera no tendremos
que consultar el índice online las siguientes veces.</p>
<pre class="code bash literal-block">
<span class="o">(</span>test3<span class="o">)</span>mgaitan@traful:~/lab/test3<span class="nv">$ </span><span class="nb">time </span>pip install --no-index --find-links<span class="o">=</span>~/.pip_packages lxml
Ignoring indexes: https://pypi.python.org/simple/
Downloading/unpacking lxml
  Running setup.py egg_info <span class="k">for </span>package lxml
    Building lxml version 3.1.1.

    <span class="o">[</span>...<span class="o">]</span>


Successfully installed lxml
Cleaning up...

real    0m38.944s
user    0m38.338s
sys 0m0.564s
</pre>
<p>Ok, ya va mejor.</p>
</div>
<div class="section" id="haciendo-que-la-cosa-vuele-no-recompiles-la-rueda">
<h2>Haciendo que la cosa vuele: no recompiles la rueda</h2>
<p>pip 1.4 (en desarrollo) trae <a class="reference external" href="https://github.com/pypa/pip/commit/5d02b5207a305543ad6ef19d6e6596ffa45b99e5">soporte integrado</a> para el nuevo formato de paquetes
<a class="reference external" href="http://wheel.rtfd.org/,">wheel</a> (superador del viejo <em>egg</em> y basado en los estándares actuales)
que es muchísimo más rápido que instalar desde fuentes (sobre todo en casos
que se debe compilar, como lxml)</p>
<p>Para usar wheel el paquete a bajar tiene que existir en dicho formato y todavía no abundan
en PyPi asi que podemos armarlos localmente con el propio pip</p>
<pre class="code bash literal-block">
pip wheel --wheel-dir<span class="o">=</span>./pip_packages lxml
</pre>
<p>Eso es similar a usar <tt class="docutils literal"><span class="pre">--download</span></tt> pero además compila y empaqueta como
un archivo <tt class="docutils literal">.whl</tt></p>
<p>Para que pip acepte instalar estos archivos hay que usar <tt class="docutils literal"><span class="pre">--use-wheel</span></tt>
y para que los busque localmente haremos:</p>
<pre class="code bash literal-block">
pip install --use-wheel --no-index --find-links<span class="o">=</span>~/.pip_packages lxml
</pre>
<p>¡Lo que tardó menos de 2 decimas de segundo! Un speedup del 90mil veces respecto al primer
y canónico <tt class="docutils literal">pip install lxml</tt></p>
<pre class="code literal-block">
(test)tin@morochita:~/lab/test$ time pip install --use-wheel --no-index --find-links=. lxml
Ignoring indexes: https://pypi.python.org/simple/
Downloading/unpacking lxml
Installing collected packages: lxml
Successfully installed lxml
Cleaning up...

real    0m0.180s
user    0m0.152s
sys 0m0.024s
</pre>
<p>Asi que ya sabés: todos esos paquetes que instalás en cada entorno (quizas ipython,
django, whatever) me los haces rodar para que pip vuele.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/desambiguando-un-hash-en-git.html" class="u-url">Desambiguando un hash en Git</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="posts/desambiguando-un-hash-en-git.html" rel="bookmark"><time class="published dt-published" datetime="2013-03-14T18:02:01-03:00" itemprop="datePublished" title="Fecha de publicación">2013-03-14 18:02</time></a></p>
                <p class="commentline">            <a href="posts/desambiguando-un-hash-en-git.html#disqus_thread" data-disqus-identifier="cache/posts/desambiguando-un-hash-en-git.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <p>Soy vago. Por eso me llevo bien con Git, que permite reconocer un changeset con un <a class="reference external" href="http://git-scm.com/book/ch6-1.html">pedacito de
su hash sha1</a> :</p>
<blockquote>
Git is smart enough to figure out what commit you meant to type if you provide the first few characters, as long as your partial SHA-1 is at least four characters long and unambiguous — that is, only one object in the current repository begins with that partial SHA-1.</blockquote>
<p>Pero a veces soy demasiado vago, y Git deja de llevarse bien conmigo: Estaba en una rama con varios commits y quería volver al pasado, deshaciendo commits, pero llevando uno. Fácil: <tt class="docutils literal">reset</tt> + <tt class="docutils literal"><span class="pre">cherry-pick</span></tt>. Pero copié muy pocos caracteres del hash que quería <em>cherrypickear</em>:</p>
<pre class="code bash literal-block">
<span class="o">(</span>cpi<span class="o">)</span>tin@morochita:~/cpi<span class="nv">$ </span>git reset --hard 772dad9a775
HEAD is now at 772dad9 making aqueous migration script more robust
<span class="o">(</span>cpi<span class="o">)</span>tin@morochita:~/cpi<span class="nv">$ </span>git cherry-pick c4396
error: short SHA1 c4396 is ambiguous.
error: short SHA1 c4396 is ambiguous
fatal: ambiguous argument <span class="s1">'c4396'</span>: unknown revision or path not in the working tree.
Use <span class="s1">'--'</span> to separate paths from revisions
<span class="o">(</span>cpi<span class="o">)</span>mgaitan@gutemberg:~/laburo/cpi/code/cpi_mrp<span class="err">$</span>
</pre>
<p>Recórcholis.</p>
<p>Un poquito de bash y <em>git plumbing</em> al rescate:</p>
<pre class="code bash literal-block">
<span class="o">(</span>cpi<span class="o">)</span>tin@morochita:~/cpi<span class="nv">$ </span><span class="k">for </span><span class="nb">hash </span>in c4396<span class="o">{{</span>0..9<span class="o">}</span>,<span class="o">{</span>a..f<span class="o">}}</span>; <span class="k">do </span>git cat-file -e <span class="nv">$hash</span> <span class="o">&amp;&amp;</span> git rev-parse <span class="nv">$hash</span>; <span class="k">done </span>2&gt;/dev/nul
c4396586273b2a9ea5eae46c4ab2d98e236e7792
c4396a2d64214a28791e4ba5a4a4017bdd9d14d6
</pre>
<p>Ahora tenemos el conjunto de hash con igual prefijo, y podemos revisarlos para ver cual era el que queriamos:</p>
<pre class="code bash literal-block">
<span class="o">(</span>cpi<span class="o">)</span>tin@morochita:~/cpi<span class="nv">$ </span>git show c4396586273b2a9ea5eae46c4ab2d98e236e7792
</pre>
<p>Y ese era el que quería.</p>
    </div>
    </article>
</div>
        <nav class="postindexpager"><ul class="pager">
<li class="next">
                <a href="index-8.html" rel="next">Posts anteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="nqnwebs";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer>
                Contents © 2014         <a href="mailto:gaitan@gmail.com">Martín Gaitán</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/88x31.png"></a>
                
            </footer>
</div>
        </div>
        <!--End of body content-->


    </div>
</div>

            <script src="assets/js/jquery.min.js"></script><script src="assets/js/bootstrap.min.js"></script><script src="assets/js/jquery.colorbox-min.js"></script><script src="assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><script src="assets/js/jquery.timeago.js" type="text/javascript"></script><script>
    jQuery(document).ready(function() {

        if(jQuery('html').attr('lang') === 'es'){
             jQuery.timeago.settings.strings = {
               prefixAgo: "hace",
               prefixFromNow: "dentro de",
               suffixAgo: "",
               suffixFromNow: "",
               seconds: "menos de un minuto",
               minute: "un minuto",
               minutes: "unos %d minutos",
               hour: "una hora",
               hours: "%d horas",
               day: "un día",
               days: "%d días",
               month: "un mes",
               months: "%d meses",
               year: "un año",
               years: "%d años"
            };
        }
        jQuery("time.published").timeago();
    });
    </script>
</body>
</html>
