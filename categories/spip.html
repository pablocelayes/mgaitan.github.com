<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><meta name="title" content="Posts sobre SPIP | &gt;&gt;&gt; me.geek.post()"><meta name="description" content="&gt;&gt;&gt; me.geek.post()"><meta name="author" content="Martín Gaitán"><title>Posts sobre SPIP | &gt;&gt;&gt; me.geek.post() </title><!-- Le styles --><link href="../assets/css/bootstrap.css" rel="stylesheet" type="text/css"><link href="../assets/css/bootstrap-responsive.css" rel="stylesheet" type="text/css"><link href="../assets/css/rst.css" rel="stylesheet" type="text/css"><link href="../assets/css/code.css" rel="stylesheet" type="text/css"><link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css"><link href="../assets/css/theme.css" rel="stylesheet" type="text/css"><link href="http://fonts.googleapis.com/css?family=OFL+Sorts+Mill+Goudy+TT:regular,italic" rel="stylesheet" type="text/css"><link href="../assets/css/custom.css" rel="stylesheet"><script src="../assets/js/jquery-1.7.2.min.js" type="text/javascript"></script><script src="../assets/js/jquery.colorbox-min.js" type="text/javascript"></script><script src="../assets/js/jquery.timeago.js" type="text/javascript"></script><script src="../assets/js/jquery.timeago.es.js" type="text/javascript"></script><script>

            jQuery(document).ready(function() {
              jQuery("span.timeago").timeago();
            });

        </script><!-- Le HTML5 shim, for IE6-8 support of HTML5 elements --><!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]--><link rel="alternate" type="application/rss+xml" title="RSS for tag SPIP (es)" href="spip.xml"></head><body>
<div class="container-fluid" id="container">
    <div class="row-fluid" id="titlerow">

    <div class="span10 offset1" id="titlecolumn">
    <!-- Banner-like substance !-->
        <div class="titlebox span3">
        <h1 id="blog-title">
            <a href="../">tin_nqn</a>
        </h1>
        <h6 id="blog-description">&gt;&gt;&gt; me.geek.post()</h6>

        
        
        
        </div>
    <div id="menu" class="span7 offset1">
      <ul class="inline"><li><a href="../archive.html">Archivos</a>
                 / 
            
                </li><li><a href="index.html">Categorías</a>
                 / 
            
                </li><li><a href="../about.html">Sobre mí</a>
                 / 
            
                </li><li><a href="../charlas.html">Charlas</a>
                
            
        </li></ul></div>
    <!-- End of banner-like substance !-->
    <div class="row" id="contentrow">
        <div class="span10 offset1" id="contentcolumn">
            <!--Body content-->
            
    
        <div class="postbox">
        <h1><a href="../posts/disqus-para-spip.html">Disqus para SPIP</a>
        <small>  
             <span class="timeago" title="2011-07-07 01:45:06">2011-07-07 01:45:06</span>
        </small></h1>
        <img alt="/images/disqus-newlod23a-8b781.gif" class="align-right" src="../images/disqus-newlod23a-8b781.gif"><p>Hace tiempo me interesa el servicio
<a class="reference external" href="http://www.disqus.com">disqus.com</a> que provee una plataforma de
comentarios muy poderosa y fácil de usar.</p>
<p>Comencé un <a class="reference external" href="http://zone.spip.org/trac/spip-zone/browser/_plugins_/disqus">pequeño
plugin</a>
para integrar Disqus a <a class="reference external" href="http://www.spip.net">Spip</a>.</p>
<table border="1" class="docutils"><colgroup><col width="100%"></colgroup><tbody valign="top"><tr><td><a class="reference external" href="../downloads/disqus.zip">Plugin Disqus para SPIP version 0.1</a></td>
</tr></tbody></table><p>Por ahora tiene dos componentes básicos:</p>
<ol class="arabic simple"><li>Un esqueleto inc-forum.html que reemplaza el esqueleto por defecto de
SPIP (y su formulario) por Disqus</li>
<li>Un esqueleto para exportar comentarios existentes (genera un XML
importable a traves del panel de disqus)</li>
</ol><p>La configuración se realiza a través de una página (requiere el <a class="reference external" href="http://plugins.spip.net/CFG">plugin
CFG</a>) donde se define el <em>"Disqus
shortname"</em> (la identificación unica que asignamos al sitio donde
usaremos Diqus).</p>
<p>Para generar el XML con la exportación de comentarios preexistentes,
basta acceder a <tt class="docutils literal"><span class="pre">/?page=export_comments_to_disqus</span></tt> y luego importar
ese archivo desde el panel de Disqus (Tools -&gt; Import/Export )</p>
        <p>
        
            <a href="../posts/disqus-para-spip.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/simplecart-js-para-spip.html">SimpleCart(js) para SPIP</a>
        <small>  
             <span class="timeago" title="2010-09-12 13:34:44">2010-09-12 13:34:44</span>
        </small></h1>
        <p><a class="reference external" href="http://simplecartjs.com/">SimpleCart</a> es un sistema para e-commerce
muy sencillo íntegramente desarrollado en javascript. Permite realizar
ventas mediante PayPal o Google Checkout y es muy extensible para
implementar otros sistemas.</p>
<p>En este domingo de procrastinación, decidí integrarlo a SPIP
[<a class="reference external" href="../blog/article/simplecart-js-para-spip#nb1">1</a>]. Lo usaré, espero que
pronto, para vender los productos del <a class="reference external" href="http://www.agrupacionmazamorra.org.ar/taller-de-serigrafia-30">taller de serígrafía de
Mazamorra</a>.</p>
<div class="section" id="como-funciona">
<h2>Cómo funciona</h2>
<p>Se instala como un plugin común y se configura mediante el plugin CFG.
Por ahora sólo soporta PayPal como medio de pago, pero incluiré otros.</p>
<p>SimpleCart usa simples señaladores html, que yo he convertido en
balizas.</p>
<p>Baliza
Descripción
#SIMPLECART_QUANTITY
Indica la cantidad de productos
#SIMPLECART_ITEMS
Muestra los items en el carrito según las cabeceras definidas en la
página de configuración
#SIMPLECART_TAX_RATE
Indica la tasa impositiva indicada en la configuración
#SIMPLECART_TAX_COST
Indica el total de impuestos
#SIMPLECART_SHIPPING_COST
Indica el costo de envío en función de la configuración definida
#SIMPLECART_TOTAL
La suma del precio de los productos en el carrito (Subtotal)
#SIMPLECART_FINAL_TOTAL
Total considerando impuestos y envío
#SIMPLECART_CHECKOUT
Genera el botón para finalizar compra (redirige al sistema de pago)
#SIMPLECART_EMPTY
Genera el botón para vaciar el carrito
Con estas balizas puedes armar el carrito en cualquier lado. Los datos
del carritos son persistentes usando cookies (incluso se conservan
durante un tiempo aunque se abandone la página).</p>
<p>Por ejemplo, este puede ser tu carrito .</p>
<pre class="literal-block">
&lt;:simplecart:your_cart:&gt; (#SIMPLECART_QUANTITY items)

#SIMPLECART_ITEMS


&lt;:simplecart:subtotal:&gt;: #SIMPLECART_TOTAL&lt;:simplecart:tax_cost:&gt; (#SIMPLECART_TAX_RATE): #SIMPLECART_TAX_COST &lt;:simplecart:shipping_cost:&gt;:  #SIMPLECART_SHIPPING_COST &lt;:simplecart:final_total:&gt;: #SIMPLECART_FINAL_TOTAL

#SIMPLECART_CHECKOUT
#SIMPLECART_EMPTY
</pre>
</div>
<div class="section" id="como-agregar-productos">
<h2>Cómo agregar productos</h2>
<p>Muy simple. Se sube una imágen como documento definiendo su título y
descripción y se la incrusta con el modelo <em>item</em>. El precio se indica
con el parámetro <em>price</em>.</p>
<p>Por ejemplo, el documento 111 se vuelve un item si se lo incluye así</p>
<p><tt class="docutils literal">&lt;item111|price=23.4&gt;</tt></p>
</div>
<div class="section" id="un-atajo-mas">
<h2>Un atajo más</h2>
<p>El código para el carrito de arriba lo incluí como un modelo para poder
incrustarlo directamente desde la redacción de un artículo con
<a href="../posts/simplecart-js-para-spip.html#id2"><span class="problematic" id="id3">``</span></a>&lt;cart1&gt; <a href="../posts/simplecart-js-para-spip.html#id4"><span class="problematic" id="id5">``</span></a>.</p>
<div class="system-message" id="id2">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 73); <em><a href="../posts/simplecart-js-para-spip.html#id3">backlink</a></em></p>
Inline literal start-string without end-string.</div>
<div class="system-message" id="id4">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 73); <em><a href="../posts/simplecart-js-para-spip.html#id5">backlink</a></em></p>
Inline literal start-string without end-string.</div>
</div>
<div class="section" id="demostracion">
<h2>Demostración</h2>
<p>Si alguien completa la transacción, lo interpretaré como una donación
:D.</p>
</div>
<div class="section" id="descarga">
<h2>Descarga</h2>
<p>El plugin está en desarrollo sobre
<a class="reference external" href="http://svn.spip.org/trac/spip-zone/browser/_plugins_/simplecart">spip-zone</a>.
Podés hacer un ckeckout SVN</p>
</div>
        <p>
        
            <a href="../posts/simplecart-js-para-spip.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/limitar-la-cantidad-de-caracteres.html">Limitar la cantidad de caracteres de los comentarios</a>
        <small>  
             <span class="timeago" title="2009-06-10 06:41:37">2009-06-10 06:41:37</span>
        </small></h1>
        <p>Si Twitter funciona con 140 caracteres los comentarios a nuestros
artículos podrían tener 200, ¿no?</p>
<p>Hay una forma fácil de limitar el largo permitido en un campo de texto
mediante jQuery, que vaya mostrando de manera interactiva la cantidad de
caracteres restantes.</p>
<p>Por ejemplo, esto limita el tamaño de un comentario en SPIP.</p>
<pre class="literal-block">
 $(document).ready(function () {

     $("#texte").before("&lt;div id='chars' style='float:right;font-weigth:strong;margin-right:5px;'&gt;&lt;/div&gt;");

$(function(){
    $('#texte').keyup(function(){
        limitChars('texte', 200, 'chars');
    })
    });
 });

function limitChars(textid, limit, infodiv) {
     var text = $('#'+textid).val();
     var textlength = text.length;
     if(textlength &gt; limit) {
         $('#' + infodiv).html('No puede ingresar m&amp;aacute;s de '+limit+' caracteres');
         $('#'+textid).val(text.substr(0,limit));
         return false;
     } else {
         $('#' + infodiv).html('Restan '+ (limit - textlength) +' caracteres.');
         return true;
     }
}
</pre>
<div class="section" id="intrucciones-para-spip">
<h2>Intrucciones para SPIP</h2>
<ol class="arabic simple"><li>Copiar el código</li>
<li>Pegarlo luego de la baliza #INSERT_HEAD de tu cabecera</li>
<li>(opcional) Cambiarle el límite (el número 200),</li>
</ol><p>¡Listo!</p>
</div>
<div class="section" id="intrucciones-generales">
<h2>Intrucciones generales</h2>
<p>Es igual al anterior, sólo debes asegurarte que tiene en jquery en la
página. Luego cambia el selector <tt class="docutils literal">#texte</tt> por el que corresponda al
campo que querés limitar.</p>
</div>
<div class="section" id="ejemplo">
<h2>Ejemplo</h2>
</div>
        <p>
        
            <a href="../posts/limitar-la-cantidad-de-caracteres.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/ultima-version-de-spip-por-svn.html">Ultima versión de Spip por SVN</a>
        <small>  
             <span class="timeago" title="2009-05-22 00:19:54">2009-05-22 00:19:54</span>
        </small></h1>
        <p>Como sabemos, el desarrollo de SPIP se realiza a través del sistema de
control de versiones Subversion.</p>
<p>A través de Subversion, podemos obtener la ultima version de desarrollo
considerada estable</p>
<pre class="literal-block">
svn checkout svn://trac.rezo.net/spip/branches/spip-2.0/  carpeta_destino
</pre>
<p>Una de las ventajas de obtener SPIP a través de SVN, es que luego es muy
fácil de actualizar.</p>
<pre class="literal-block">
cd  carpeta_destino
svn update
</pre>
<p>Subversion asigna un numero de revision a cada cambio realizado al
conjunto de archivos. Así, cuando los desarrolladores lo evaluan
pertinente, en un determinado momento del desarrollo se empaqueta una
nueva version "oficial"</p>
<p>Por ejemplo, la revisión
<a class="reference external" href="http://trac.rezo.net/trac/spip/browser/branches/spip-2.0?rev=13982">13982</a>
es la version 2.08 de Spip.</p>
<p>Podemos obtener una revision específica con el parámetro -r. Por
ejemplo, el siguiente comando obtendría una copia de SPIP 2.08</p>
<pre class="literal-block">
svn -r 13982 checkout svn://trac.rezo.net/spip/branches/spip-2.0/  carpeta_destino
</pre>
<p>Genial, pero para para asegurarnos estar en una revision que se
corresponda con una "version oficial" tenemos que saber el número de ID.</p>
<p>En el <a class="reference external" href="http://trac.rezo.net/trac/spip/wiki">Trac de Spip</a> se mantiene
una tabla donde se especifica esta correspondencia para cada nueva
version, pero a decir verdad, es un engorro tener que ingresar sólo para
averiguar un número. Mejor hagámoslo automático!</p>
<div class="section" id="automatizando-la-obtencion-de-un-spip-oficial-por-svn">
<h2>Automatizando la obtención de un SPIP oficial por SVN</h2>
<pre class="literal-block">
#!/bin/bash
#script para una instalacion de spip a traves de svn

if [ $# -lt 1 ]
then
echo "Debe indicar al menos un parametro:"
echo "$0 destino [rev]"
echo
exit 1
fi


if [ $# -eq 2 ]
then
REV=$2
else
echo "Averiguando revision de la ultima release..."
REV=$(svn info svn://trac.rezo.net/spip/archivelist.txt | sed -n '9p' | cut -d' ' -f5)
fi


echo "Recuperando la version $REV de SPIP"
svn checkout -r `echo $REV` svn://trac.rezo.net/spip/branches/spip-2.0/ $1 1&gt;/dev/null
echo "Configurando permisos..."
cd $1
chmod 657 IMG local tmp config
echo "Lanzando el navegador para continuar la instalacion..."
firefox http://localhost/~tin/$1/ecrire
</pre>
<p>Este script hace el trabajo aburrido por nosotros. Averigua cuál fue la
última modificación de <em>archivelist.txt</em> que es un archivo que se
modifica en cada nuevo lanzamiento de paquete. ¡Es el dato que nos hacía
falta!</p>
</div>
<div class="section" id="una-solucion-mas-genuina">
<h2>Una solución más genuina</h2>
<p><strong>Atención</strong>: Ya me hicieron caso. <a class="reference external" href="../blog/article/ultima-version-de-spip-por-svn#update">Ver
actualización</a></p>
<p>Aunque el hacking (como este) es sano y divertido (y a veces también
útil), la solución más genuina sería que los desarrolladores de SPIP
mantengan un <strong>tag</strong> por cada nuevo empaquetamiento y uno que apunte
siempre al último.</p>
<p>Por ejemplo, con el siguiente comando deberiamos obtener la version 2.05
(sin saber a qué numero de revision corresponde)</p>
<pre class="literal-block">
svn checkout svn://trac.rezo.net/spip/tags/2.05
</pre>
<p>y con este otro obtener la <strong>última</strong> versión</p>
<pre class="literal-block">
svn checkout svn://trac.rezo.net/spip/tags/lastest-version
</pre>
<p>Esto, por ahora, no está implementado, pero ya hice llegar mi propuesta
a <em>l’equipe</em> de SPIP, y <a class="reference external" href="http://article.gmane.org/gmane.comp.web.spip.devel/53503">lo están
discutiendo</a></p>
</div>
<div class="section" id="actualizacion">
<h2>Actualización</h2>
<p>Gracias a <a class="reference external" href="http://my.opera.com/tech-nova/blog/">Gilles</a> el Dev Team
adoptó mi propuesta y ahora existen Tags en el arbol SVN de spip. En
particular,</p>
<pre class="literal-block">
svn co svn://trac.rezo.net/spip/tags/spip-2-stable
</pre>
</div>
        <p>
        
            <a href="../posts/ultima-version-de-spip-por-svn.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/lorem-ipsum-para-spip.html">Lorem Ipsum para Spip</a>
        <small>  
             <span class="timeago" title="2009-03-26 20:39:24">2009-03-26 20:39:24</span>
        </small></h1>
        <p><a class="reference external" href="http://es.wikipedia.org/wiki/Lorem_ipsum">Lorem ipsum</a> es el texto
que se usa habitualmente en diseño gráfico en demostraciones de
tipografías o de borradores de diseño para probar el diseño visual antes
de insertar el texto final.</p>
<p>Cuando estamos desarrollando necesitamos ver cómo quedará el contenido,
y debemos recurrir a un <em>copy &amp; paste</em> de caulquier cosa que tengamos a
mano.</p>
<p>La ventaja de un <em>Lorem Ipsum</em> sobre otros textos, es que este tiene una
distribución del largo de las palabras bastante natural de las palabras
lo que en textos largos queda mucho mejor que repetir un mismo fragmento
una y otra vez.</p>
<p>Hay muchos <a class="reference external" href="http://www.lipsum.com/">generadores de texto Lorem Ipsum</a>
en internet, pero lo podemos hacer aún más fácil.</p>
<div class="section" id="un-lorem-ipsum-automatico">
<h2>Un Lorem Ipsum automático</h2>
<p>Con la ayuda del plugin <a class="reference external" href="http://sanderkorvemaker.nl/jquery/jLorem.php">jQuery Lorem
Ipsum</a> de Sander Korve
hice un modelo (instalable como plugin) que permite insertar un texto
del tamaño que queramos (por omisión, de 4 párrafos).</p>
<p>Podés bajarlo desde acá:</p>
<table border="1" class="docutils"><colgroup><col width="100%"></colgroup><tbody valign="top"><tr><td><a class="reference external" href="../downloads/loremipsum.zip">|image1|</a></td>
</tr><tr><td>Lorem Ipsum Plugin version 0.2</td>
</tr></tbody></table><p>O por SVN:</p>
<pre class="literal-block">
svn checkout svn://zone.spip.org/spip-zone/_plugins_/_test_/loremipsum
</pre>
</div>
<div class="section" id="instalacion">
<h2>Instalación</h2>
<p>La instalación es igual que con la de cualquier plugin: descomprimirlo
en la carpeta <em>/plugins</em> y activarlo.</p>
<p>Requiere además que los esqueletos tengan la baliza <tt class="docutils literal">#INSERT_HEAD</tt>
dentro del header, ya que allí se incluirá el javascript necesario para
su funcionamiento.</p>
</div>
<div class="section" id="funcionamiento-basico">
<h2>Funcionamiento básico</h2>
<p>La inclusión de un <em>Lorem Ipsum</em> se basa en el modelo <em>lorem.html</em>
incluído con el plugin, por lo que hay dos maneras de llamarlo:</p>
<p><img alt="-" src="../posts/local/cache-vignettes/L8xH11/puce-32883.gif"> En el cuerpo (texto, descripción, etc) de un artículo: <tt class="docutils literal">&lt;lorem&gt;</tt></p>
<p><img alt="image3" src="../posts/local/cache-vignettes/L8xH11/puce-32883.gif"> Predefinido en un esqueleto: <tt class="docutils literal">#MODELE{lorem}</tt></p>
<p>¡y listo!</p>
</div>
<div class="section" id="parametros">
<h2>Parámetros</h2>
<p>El modelo acepta algunos parámetros para configurar la longitud del
texto. Por ejemplo <tt class="docutils literal">&lt;lorem5&gt;</tt> creará 5 párrafos.</p>
<p>Pero también se puede especificar más datos:</p>
<p><img alt="image4" src="../posts/local/cache-vignettes/L8xH11/puce-32883.gif"><strong>type</strong>: permite especificar que tipo de resultado se quiere.
Las opciones válidas son <strong>paragraphs</strong>, <strong>words</strong> o <strong>characters</strong> para
párrafos, palabras o characteres. Así: creará un texto de 25 palabras.
El valor por omisión es <strong>paragraphs</strong>.</p>
<p><img alt="image5" src="../posts/local/cache-vignettes/L8xH11/puce-32883.gif"><strong>amount</strong>: Es lo mismo que el ID pasado al modelo: es lo mismo
que . Por ejemplo <tt class="docutils literal"><span class="pre">[(#MODELE{lorem}{amount=5})]</span></tt>
[<a class="reference external" href="../blog/article/lorem-ipsum-para-spip#nb1">1</a>].</p>
<p><img alt="image6" src="../posts/local/cache-vignettes/L8xH11/puce-32883.gif"><strong>ptags</strong>: Permite agregar las etiquetas &lt;code&lt;&gt;P&lt;&gt;/code&gt;
alrededor de cada párrafo. Los valores aceptados son <strong>true</strong> o
<strong>false</strong>. Por omisión es <strong>true</strong>.</p>
</div>
<div class="section" id="una-astucia">
<h2>Una astucia</h2>
<p>Una forma de mostrar contenido en un artículo (o cualquier elemento) sin
tener que editar cada artículo sólo para poner <tt class="docutils literal">&lt;lorem&gt;</tt> es invocar el
modelo siempre y cuando no exista contenido en la baliza</p>
<p>Por ejemplo [<a class="reference external" href="../blog/article/lorem-ipsum-para-spip#nb2">2</a>]:</p>
</div>
        <p>
        
            <a href="../posts/lorem-ipsum-para-spip.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/variar-o-no-variar-esa-es-la.html">Variar o no variar, esa es la cuestión</a>
        <small>  
             <span class="timeago" title="2009-03-15 20:03:38">2009-03-15 20:03:38</span>
        </small></h1>
        <p>Hace algunos días, en
<a class="reference external" href="http://listes.rezo.net/mailman/listinfo/spip-es">spip-es</a> se planteó
la duda de cómo controlar una cabecera diferente para algunas secciones
en particular.</p>
<p><a class="reference external" href="http://archives.rezo.net/spip-es.mbox/200903.mbox/%3C29008.88.7.114.173.1236164746.squirrel@correo.nodo50.org%3E">Xabi
aportó</a>
la solución canónica, que es crear esqueletos ad-hoc para cada sección
difente, valiendose de los esqueletos con forma <em>rubrique-X.html</em> (donde
X es el ID de la sección).</p>
<p>Esto se describe en el apartado "<a class="reference external" href="http://www.spip.net/es_article2257.html">Para ir más
lejos</a>" de la documentación.</p>
<p>En este caso particular, sólo se quería mostrar el logo en la cabecera
para algunas secciones. El problema es que las secciones "diferentes"
serían iguales entre sí, pero invocando distintos esqueletos. Esto
contradice el <a class="reference external" href="http://es.wikipedia.org/wiki/DRY">principio DRY</a>
siempre deseable en todo desarrollo de software.</p>
<p>Una forma sencilla, pero a la vez parcial de resolver esto, es hacer un
<a class="reference external" href="http://es.wikipedia.org/wiki/enlace_duro">enlace duro</a> entre los
esqueletos que son iguales.</p>
<p>Por ejemplo, la sección 2, la 4 y la 6, tendrán el mismo esqueleto.
Entonces creamos el rubrique-2.html y definimos rubrique-4.html y
rubrique-6.html como enlaces duros al primero. Desde la línea de
comandos:</p>
<pre class="literal-block">
$ ln rubrique-2.html rubrique-4.html
$ ln rubrique-2.html rubrique-6.html
</pre>
<p>Esta solución funciona, pero es sólo para servidores <em>*nix</em> y teniendo
acceso a la consola (por <a class="reference external" href="http://es.wikipedia.org/wiki/SSH">SSH</a>, por
ejemplo). Además, hay que documentar bien qué se está haciendo, porque
da lugar a errores cuando dos esqueletos "linkeados" intentan ser
iguales.</p>
<p>Por suerte, hay varias otras maneras de resolver esto,</p>
<div class="section" id="filtros-de-condicion-o-filtro-match">
<h2>Filtros de condición o filtro match</h2>
<p><a class="reference external" href="http://archives.rezo.net/spip-es.mbox/200903.mbox/%3C516299.21618.qm@web90607.mail.mud.yahoo.com%3E">Esta
solución</a>,
es la que aportó <a class="reference external" href="http://www.graciasdenada.com.ar/">Juan Pablo
Portugau</a>.</p>
<p>Lo que plantea, es usar la baliza #ID_RUBRIQUE (que obviamente,
devuelve el número de la sección) con filtros de comparación. Es,
hablando en geek, un simple <strong>if</strong>: <em>Si es la sección 2, mostrar el
logo. Sino, nada</em>:</p>
<p>En código SPIP:</p>
<pre class="literal-block">
[(#ID_RUBRIQUE|=={2}|?{'#LOGO_RUBRIQUE',''})]
</pre>
<p>La limitación de esta solución se da cuando son múltiples los valores
posibles. En nuestro caso, se debe mostrar el logo cuando se trata de la
sección 2, de la 4 o de la 6. Juan Pablo propone anidar esta estructura.</p>
<pre class="literal-block">
[(#ID_RUBRIQUE|=={2}|?{'#LOGO_RUBRIQUE',[(#ID_RUBRIQUE|=={4}|?{'#LOGO_RUBRIQUE',[(#ID_RUBRIQUE|=={6}|?{'#LOGO_RUBRIQUE',''})]})]})]
</pre>
<p>Aunque es sintácticamente correcto, el código resultante es bastante
inmantenible para un ser humano con cerebro normal y el monito parseador
de SPIP queda agitado.</p>
<p>Para eso existe el filtro
<a class="reference external" href="http://www.spip.net/fr_article901.html#match">match</a>, que se vale de
las <a class="reference external" href="http://www.regular-expressions.info/">expresiones regulares</a> para
que hagamos nuestro festín.</p>
<p>Lo de arriba, puede reducirse a esto:</p>
<pre class="literal-block">
[(#ID_RUBRIQUE|match{^(2|4|6)$}|?{'#LOGO_RUBRIQUE',''})]
</pre>
<p>El filtro devuelve <strong>VERDADERO</strong> si el valor de #ID_RUBRIQUE empieza
con 2, 4 o 6 y termina con nada. Que es, dicho de otra manera, lo que
queremos.</p>
</div>
<div class="section" id="y-aun-mas-claro-bucles-como-filtros">
<h2>Y aún más claro: bucles como filtros</h2>
<p>Las expresiones regulares <em>no son moco de pavo</em>, diría mi abuela. Super
potentes, pero poco escalables en la curva complejidad-comprensibilidad.</p>
<p>Hay una solución que es muy útil, sencilla pero no trivial: usar un
bucle como filtro.</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 100)</p>
Literal block expected; none found.</div>
<p>La explicación es de la lógica de conjuntos: los criterios de un bucle
funcionan como condiciones AND. Deben cumplirse todas. En este caso, el
primer criterio <tt class="docutils literal">{id_rubrique IN (1,2,4)}</tt> exige que el id_rubrique
sea 1, 2 o 4. En el segundo <tt class="docutils literal">{id_rubrique}</tt>, se exige que sea el que
viene en contexto. Por lo tanto, este bucle sólo funcionará (mostrará el
logo) si el id_rubrique <em>del contexto</em> es 1, 2 o 4. En lógica, es una
operación <a class="reference external" href="http://es.wikipedia.org/wiki/Disyunci%C3%B3n_l%C3%B3gica">O
exclusiva</a></p>
<p>Funciona, es más legible que cualquiera de las otras soluciones y además
permite una clausula <em>ELSE</em> mucho más accesible, simplemente usando la
estructura completa del bucle.</p>
</div>
        <p>
        
            <a href="../posts/variar-o-no-variar-esa-es-la.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/una-mejor-manera-de-controlar-los.html">Una mejor manera de controlar los atributos en SPIP</a>
        <small>  
             <span class="timeago" title="2009-03-12 06:29:35">2009-03-12 06:29:35</span>
        </small></h1>
        <p>Muchas balizas SPIP generan código HTML como salida (las balizas
#LOGO_* y los filtros |image_* son los más notorios) y
frecuentemente necesitamos o queremos modificar este código autogenerado
en nuestros esqueletos. Hay diversos filtros para ayudarnos a esto
(<a class="reference external" href="http://www.spip.net/en_article2465.html#inserer_attribut">inserer_attribut</a>
para insertar atributos y
<a class="reference external" href="http://www.spip.net/en_article2465.html#extraire_attribut">extraire_attribut</a>
para extraer el valor de uno generado) pero son particularmente largos y
tediosos de tipear.</p>
<p>Más allá de eso, aunque uso estos filtros bastantes seguido para
implementar cosas como galerías de imágenes, todavía pienso lo difícil
que es escribir las palabras en francés sin equivocarme. Por suerte, un
pequeño wrapper, puede suavizar este inconveniente.</p>
<p>Cuando se trata de acceder y modificar atributos de valores de atributos
nada, en mi opinión, llega tan lejos como <a class="reference external" href="http://docs.jquery.com/Attributes">la API de atributos de
jQuery</a>. El <a class="reference external" href="http://docs.jquery.com/Attributes/attr">método de jQuery
*attr*</a> por sí solo, permite
leer y escribir el valor de cualquier atributo en cualquier nodo. Recibe
uno o dos parámetros, el nombre del atributo, y opcionalmente, el valor.</p>
<p>Si sólo se especifica el nombre, entonces <em>attr</em> extrae y devuelve el
valor de ese atributo. Si ambos parámetros son pasados al método,
entonces attr modifica el objeto configurando el atributo en cuestión
con el valor dado. Es jerga de Programación Orientada a Objetos, es un
estilo de interfaz "polimórfica" — cuando un solo método tiene dos
comportamientos complementarios que son distinguidos por el número y/o
el tipo de los argumentos dados — que está por todos lados en jQuery y
es una de las razones por las que este framework es tan conciso y
productivo.</p>
<p>Considerandola como la mejor estructura para este tipo de interfaces que
conozco (y también, que uso diariamente), decidí ue mi wrapper tendría
que copiarlo. Así fue como el <em>attr</em> nació.</p>
<p>Como el método de jQuery, el filtro <em>attr</em> de SPIP toma uno o dos
parámetros (y un objeto "implícito", pero lo ignoraremos por el
momento). Si sólo pasamos uno, este lo remite como entrada a
<em>extraire_attribut</em> para obtener el valor correspondiente. Si se lo
llama con dos parámetros, entonces llama a <em>inserer_attribut</em> para
modificar el objeto.</p>
<p>Como la idea, el código es razonablemente sencillo; la únca</p>
<p>Like the idea, the code is reasonably straightforward; quizas lo único
un poco inusual el uso de
<a class="reference external" href="http://php.net/func_get_args">func_get_args</a> para obtener el
conjunto de los argumentos pasados a la función llamada. Con ese array
podermos usar <a class="reference external" href="http://php.net/count">count</a> para saber cuantos
argumentos se pasaron y decidir qué se debe hacer. Esto es más seguro
que especificar y evaluar valores por defecto (FALSE o NULL, por
ejemplo) porque algunos usuarios genuinamente podrían querer usar esos
valores (supongamos que NULL signifique eliminar el atributo en una
futura versión).</p>
<pre class="literal-block">
include_spip("inc/filtres");

/**
 * The `attr` function allows the user to get and set the attributes of an HTML tag.
 * It is intended to be used as a SPIP filter and depends on existing SPIP functionality.
 *
 * @param $tag
 *     The HTML code.
 * @param $name
 *     The name of the attribute.
 * @param $val...
 *     The new value for the attribute $nom. Optional.
 * @return
 *     If $val was given, the code for tag with $name=$val
 *     Otherwise, the value for the $name attribute in $tag.
 */
function attr($tag, $name){
        $args = func_get_args();

        if (count($args) &gt; 2) {
                // SET
                return  inserer_attribut($tag, $name, $args[2]);
        } else {
                // GET
                return extraire_attribut($tag, $name);
        }
}
</pre>
<p>Simplemente copia el código en mes_fonctions.php (Mira "Agregar
funciones propias" en la documentación sobre <a class="reference external" href="../posts/Agregar%20funciones%20propias">filtros de
spip</a>) y luego usa el filtro attr en
tus esqueletos:</p>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 94)</p>
Literal block expected; none found.</div>
<p>Hay algunos cambios que se puede hacer a esta función: pasar $args
directamente a inserer_attribut y extraire_attribut en vez de las
variables individuales, agregar un parámetro $value=FALSE que sólo sirva
para la claridad de la documentación , y el mencionado, eliminar
atributos cuando se pase por ejemplo NULL como parámetro.</p>
        <p>
        
            <a href="../posts/una-mejor-manera-de-controlar-los.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/personalizar-el-texto-de.html">Personalizar el texto de #INTRODUCTION</a>
        <small>  
             <span class="timeago" title="2009-03-10 10:38:44">2009-03-10 10:38:44</span>
        </small></h1>
        <p>Desde la versión 1.4, SPIP tiene una baliza calculada <tt class="docutils literal">#INTRODUCTION</tt>
que como su nombre indica, sirve para presentar una introducción al
artículo completo.</p>
<p>En la <a class="reference external" href="http://www.spip.net/es_article116.html">documentación explica</a></p>
<blockquote>
#INTRODUCTION: [SPIP 1.4] si el artículo contiene una descripción,
esta se utiliza aquí; si no, SPIP muestra los 600 primeros
caracteres del inicio del artículo (del epígrafe, y luego del
texto).</blockquote>
<p>En la versión 1.92 se incorporó otro atajo para indicar el largo del
texto mostrado (sobrecargando los 600 caracteres por omisión).</p>
<p>Así, <a href="../posts/personalizar-el-texto-de.html#id1"><span class="problematic" id="id2">``</span></a>#INTRODUCTION{150} `` mostrará la descripción, si existe, o los
primeros 150 caracteres del epigrafe y/o el texto.</p>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils">&lt;string&gt;</tt>, line 15); <em><a href="../posts/personalizar-el-texto-de.html#id2">backlink</a></em></p>
Inline literal start-string without end-string.</div>
<p>Pero con la versión 2 llegó por fin un control más profundo para los
redactores. Es posible definir cual es el texto que se mostrará con
#INTRODUCTION encerrandolo entre la etiquetas <tt class="docutils literal"><span class="pre">&lt;intro&gt;...&lt;/intro&gt;</span></tt> en
el cuerpo del artículo.
[<a class="reference external" href="../blog/article/personalizar-el-texto-de#nb1">1</a>]</p>
<p>Así podemos redactar nuestro artículo con la siguiente estructura:</p>
<pre class="literal-block">
Esta oración es la introducción al articulo. Y acá sigue mi artículo completo.
</pre>
<p>Suponiendo que la baliza #INTRODUCTION se muestra en el esqueleto de
seccion, allí se vería el texto</p>
<blockquote>
Esta oración es la introducción al articulo.</blockquote>
<p>Y donde esté la baliza #TEXTE:</p>
<blockquote>
Esta oración es la introducción al articulo. Y acá sigue mi artículo
completo.</blockquote>
        <p>
        
            <a href="../posts/personalizar-el-texto-de.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/c-automatico.html">© automático</a>
        <small>  
             <span class="timeago" title="2009-03-07 17:28:08">2009-03-07 17:28:08</span>
        </small></h1>
        <p>Más por costumbre que utilidad solemos poner la antigüedad de un sitio
web al pie de página, asociado al símbolo ©, o (cc) si usamos <a class="reference external" href="http://es.wikipedia.org/wiki/Creative_Commons">Creative
Commons</a>.</p>
<p>En el 2007 hicimos el sitio, y en este 2009 todavía muestra.</p>
<blockquote>
© 2007</blockquote>
<p>¡Muy feo! Aunque no hayamos actualizado el sitio desde entonces, nuestro
deber, como buenos mentirosos, es lograr que el visitante no se entere.</p>
<p>Así que podemos hacer que el año, o el período <strong>Año inicio - Año
actual</strong> se actualice automáticamente.</p>
<p>Muy simple:</p>
<pre class="literal-block">
© &lt;BOUCLE_yearbegin(ARTICLES){par date}{0,1}&gt;
    #SET{year, #DATE|annee} #GET{year}
  &lt;/BOUCLE_yearbegin&gt;
[(#GET{year}|=={#DATE|annee}|?{'' , - #DATE|annee} )]
</pre>
<div class="section" id="explicacion">
<h2>Explicación</h2>
<ul class="simple"><li>Por convención, asumimos que el año de inicio del sitio es el año del
primer artículo publicado, lo cual a mi me suena bastante lógico.</li>
<li>Un bucle recupera esta información, la muestra y a la vez la
guarda en una variable spip <tt class="docutils literal">#SET{year, #DATE|annee}</tt>.</li>
<li>Fuera del bucle comparamos el año ya mostrado con el actual,
obtenida de la baliza <tt class="docutils literal">#DATE</tt> sin contexto. Si son iguales,
no se muestra nada más (para que no quede algo como
<strong>© 2009 - 2009</strong>, que quedaría bien feo).
Pero si son distintos, se muestra el año actual</li>
</ul><p>El resultado, será:</p>
<blockquote>
© 2007 - 2009</blockquote>
<p>Y si la lógica o el reloj del servidor no fallan, en cada año nuevo se
incrementará el año final del período sin que toquemos una línea de código.</p>
</div>
        <p>
        
            <a href="../posts/c-automatico.html#disqus_thread">Comments</a>
        
        </p></div>
    
        <div class="postbox">
        <h1><a href="../posts/suscribirse-a-los-comentarios-por.html">Suscribirse a los comentarios por RSS</a>
        <small>  
             <span class="timeago" title="2009-02-27 21:04:48">2009-02-27 21:04:48</span>
        </small></h1>
        <p>Con SPIP 2.0, más precisamente en la revisión
<a class="reference external" href="http://trac.rezo.net/trac/spip/browser/spip/squelettes-dist/rss_forum_article.html?rev=13407">13407</a>
se agregaron algunos esqueletos al juego de esqueletos estándar.</p>
<p>Unos muy interesantes son los que permiten suscribirse a los
comentarios.</p>
<pre class="literal-block">
squelettes-dist/rss_forum_article.html
squelettes-dist/rss_forum_breve.html
squelettes-dist/rss_forum_rubrique.html
squelettes-dist/rss_forum_syndic.html
squelettes-dist/rss_forum_thread.html
</pre>
<p>Por ejemplo, en el foro de un articulo, podriamos incluir el siguiente
código, antes del bucle de comentarios de un artículo:</p>
<pre class="literal-block">
[] Suscribite a los comentarios de este artículo
</pre>
<p>Un código análogo, llamando al esqueleto correspondiente y pasando el
parámetro correcto, sirve para las breves, las secciones, los artículos
sindicados y los hilos de discusión (en foros con comentarios anidados).</p>
        <p>
        
            <a href="../posts/suscribirse-a-los-comentarios-por.html#disqus_thread">Comments</a>
        
        </p></div>
    
    <div>
<ul class="pager"><li class="next">
        <a href="spip-1.html">Posts anteriores  →</a>
    </li>
  
</ul></div>
    
        <script type="text/javascript"> var disqus_shortname = 'nqnwebs'; (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = 'http://' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script><!--End of body content--><hr><small>Contents © 2012 Martín Gaitán</small>
        </div>
    </div>
    <div class="row">
        <div class="span10 offset1" id="sidebar">
            <!--Sidebar content-->
            <ul class="inline"><li><a href="http://www.textosypretextos.com.ar" title="Mi otro blog">Textos y pretextos</a>
                    /
                </li><li><a href="http://nikola.ralsina.com.ar">Powered by Nikola</a>
                /
            </li><li> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
                        <img alt="Licencia Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/2.5/ar/80x15.png"></a>
            </li></ul><!--End of sidebar content--></div>
    
    
    <script type="text/javascript">jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"80%",maxHeight:"80%",scalePhotos:true});</script></div></div></div></div></body></html>