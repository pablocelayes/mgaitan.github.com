<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Referenciar figuras por número en Sphinx / Latex | tin_nqn  </title>
<link href="../assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="../assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="../en/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="../rss.xml">
<link rel="canonical" href="http://mgaitan.github.io/posts/referenciar-figuras-por-numero-en.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Martín Gaitán">
<meta name="og:title" content="Referenciar figuras por número en Sphinx / Latex">
<meta name="og:url" content="http://mgaitan.github.io/posts/referenciar-figuras-por-numero-en.html">
<meta name="og:description" content='El viernes presenté el draft para la revisión final de mi proyecto
integrador (a.k.a. tesis).
Tentativamente (¡a esta altura y todavía no es seguro!) se titula
"Software para graficación de digramas t'>
<meta name="og:site_name" content="tin_nqn">
<meta name="og:type" content="article">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator:id" content="40654511">
</head>
<body>

<!-- Menubar -->

<nav class="navbar navbar-static-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://mgaitan.github.io/">

                <div id="blog-title">
                    tin_nqn
                    <span id="blog-description">&gt;&gt;&gt; me.geek.post()</span>
                </div>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
<li>
<a href="../about.html">Sobre mí</a>
                </li>
<li>
<a href="../charlas.html">Charlas</a>
                </li>
<li>
<a href="../archive.html">Archivos</a>
                </li>
<li>
<a href="../categories/index.html">Categorías</a>
                </li>
<li>
<a href="../rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>            </li>
<li><a href="../en/index.html" rel="alternate" hreflang="en">English</a></li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">

            <div class="col-md-offset-2 col-md-8">
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="#" class="u-url">Referenciar figuras por número en Sphinx / Latex</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Martín Gaitán</span></p>
            <p class="dateline"><a href="#" rel="bookmark"><time class="published dt-published" datetime="2011-03-19T23:13:01-03:00" itemprop="datePublished" title="Fecha de publicación: 19/03/11 23:13:01">19/03/11 23:13:01</time></a></p>
                <p class="commentline">            <a href="referenciar-figuras-por-numero-en.html#disqus_thread" data-disqus-identifier="cache/posts/referenciar-figuras-por-numero-en.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>El viernes presenté el draft para la revisión final de mi <a class="reference external" href="blog/article/preparados-listos-en-un-rato">proyecto
integrador</a> (a.k.a. tesis).
Tentativamente (¡a esta altura y todavía no es seguro!) se titula
<em>"Software para graficación de digramas termodinámicos"</em> y se puede
chusmear
<a class="reference external" href="http://gpec2010.googlecode.com/svn/trunk/docs/_build/html/index.html">acá</a>.</p>
<p>Como verán, lo hice con <a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a>, generando
LaTeX y compilando luego a PDF. Estoy más que satisfecho del resultado.</p>
<p>Sin embargo, un problema de Sphinx/Docsutils (y esto viene a ser el
verdadero tema de este post) es es que si bien están llenos de pulentez
y se la bancan mil, no están "pensados" para escribir tesis sino
documentación/manuales de software. Esto se nota, sobre todo, en la
subutilización de recursos de LaTeX a los que "no se accede" desde
restructuredText.</p>
<p>El caso paradigmático es la referenciación de figuras. En las versiones
"imprimibles" que se generan con LaTeX suele pasar que una figura no
quepa en una página y el compilador, al medir y darse cuenta, la manda a
una página siguiente. Esto hace indispensable ser preciso en la
referencia ya que un mensaje como <em>"en la siguiente figura"</em> puede estar
seguido de toda una página sin figuras.</p>
<p>Para hacer una referenciar una figura en Sphinx hay que declarar un
target</p>
<pre class="literal-block">
.. _ok:

.. figure:: ok.png

   Una imágen
</pre>
<p>y luego usar el rol <tt class="docutils literal">:ref:</tt>. Por ejemplo:</p>
<pre class="literal-block">
Referenciando la figura :ref:`ok` se evidencia el problema.
</pre>
<p>El problema es que el LaTeX generado por Sphinx no hace exáctamente una
referencia a la figura, sino un hipervínculo (hyperref). Como texto de
ese hipevinculo usa el epígrafe de la figura, lo cual es horrible e
inútil para textos cientificos/académicos. El issue, <a class="reference external" href="https://bitbucket.org/birkenfeld/sphinx/issue/76/proper-references-to-figures-code-tables">está reportado
hace más de 2
años</a>.</p>
<p>Con el estilo gronchohacker que se me está volviendo costumbre, hice
unos cambiecitos para que funcaran las referencias como tienen que ser,
por número. La directiva es particularmente fácil en LaTeX: <tt class="docutils literal">~\ref{}</tt>.
En concreto, el "gronchohackeo" se trata de cambiar
<tt class="docutils literal"><span class="pre">{\hyperref[label]{\emph{epigrafe}}}</span></tt> por <tt class="docutils literal">~\ref{label}</tt>.</p>
<p>Para garantizar compatibilidad con los que les gusta que el título de la
referencia sea el epígrafe y no el número, lo hice opcional: toda
referencia a un destino con sufijo <tt class="docutils literal"><span class="pre">-num</span></tt> usa una referencia númerica
en vez de un hipervinculo con texto.</p>
<p>Acá el <a class="reference external" href="http://nqnwebs.com/sites/www.nqnwebs.com/IMG/txt/sphinx-issue76.txt">patch</a></p>
<p>Y acá un <a class="reference external" href="http://nqnwebs.com/sites/www.nqnwebs.com/IMG/pdf/prueba.pdf">ejemplo del problema y la gronchosolución</a></p>
<p>El código del ejemplo es este:</p>
<pre class="literal-block">
Ejemplo
*******

Referenciando la figura :ref:`ok` se evidencia el problema. Aplicando mi
rústico parche en cambio, se puede referenciar a la Figura :ref:`ok-num`.

.. _ok:

.. figure:: ok.png

   Una imágen

.. _ok-num:

.. figure:: ok.png
</pre>
    </div>

    <hr>
<div class="ps">
            <div class="metadata posttranslations translations">
            <h3 class="posttranslations-intro">También disponible en:</h3>
        </div>

    <p>El código de este artículo está disponible en  <a href="https://github.com/mgaitan/mgaitan.github.com/blob/writing/posts/referenciar-figuras-por-numero-en.rst" id="sourcelink">github</a>. ¿Encontraste un error? Por favor,  <a href="https://github.com/mgaitan/mgaitan.github.com/edit/writing/posts/referenciar-figuras-por-numero-en.rst" id="sourcelink">enviame un pull request</a>.</p>
    </div>

    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../categories/python.html" rel="tag">python</a></li>
        </ul>
<ul class="pager">
<li class="previous">
                <a href="yendo-a-las-fuentes-de-cuevana-tv.html" rel="prev" title="Yendo a las fuentes de cuevana.tv">Post anterior</a>
            </li>
            <li class="next">
                <a href="el-quijote-del-software-libre.html" rel="next" title="El Quijote del Software Libre">Siguiente post</a>
            </li>
        </ul></nav></aside><section class="comments"><h2>Comentarios</h2>
                        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="nqnwebs",
            disqus_url="http://mgaitan.github.io/posts/referenciar-figuras-por-numero-en.html",
        disqus_title="Referenciar figuras por n\u00famero en Sphinx / Latex",
        disqus_identifier="cache/posts/referenciar-figuras-por-numero-en.html",
        disqus_config = function () {
            this.language = "";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="//disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="nqnwebs";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer>
                Contents © 2014         <a href="mailto:gaitan@gmail.com">Martín Gaitán</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png"></a>
                
            </footer>
</div>
        </div>
        <!--End of body content-->


    </div>
</div>

            <script src="../assets/js/jquery.min.js"></script><script src="../assets/js/bootstrap.min.js"></script><script src="../assets/js/jquery.colorbox-min.js"></script><script src="../assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><script src="../assets/js/jquery.timeago.js" type="text/javascript"></script><script>
    jQuery(document).ready(function() {

        if(jQuery('html').attr('lang') === 'es'){
             jQuery.timeago.settings.strings = {
               prefixAgo: "hace",
               prefixFromNow: "dentro de",
               suffixAgo: "",
               suffixFromNow: "",
               seconds: "menos de un minuto",
               minute: "un minuto",
               minutes: "unos %d minutos",
               hour: "una hora",
               hours: "%d horas",
               day: "un día",
               days: "%d días",
               month: "un mes",
               months: "%d meses",
               year: "un año",
               years: "%d años"
            };
        }
        jQuery("time.published").timeago();

        jQuery('article:not(:first)').before('<hr>');

        jQuery('.highlight pre').addClass('code');
    });
    </script>
</body>
</html>
